---
title: Online measurements of heavy meson correlators
author: Simone Romiti
date: last-modified
jupyter: python3
format-links: false # hide the existence of other formats
format:
  html:
    toc: true
    toc-location: body
    embed-resources: true # standalone html
    html-math-method: mathjax # use the common latex commands
    include-in-header: mathjax-config.html # equation numbering with sections
    fontsize: 14pt
  pdf:
    pdf-engine: pdflatex
    fontsize: 12pt
bibliography: bibliography.bib
csl: acta-ecologica-sinica.csl
fontsize: 16pt
---

`tmLQCD`can compute the correlators for the heavy mesons $K$ and $D$.
The twisted mass formulation of the heavy doublet $(s, c)$ is such that $K$ and $D$ mix in the spectral decomposition @baron2011computing.
In fact, the Dirac operator is not diagonal in flavor,
and the extraction of their masses requires the evaluation of a $(2 \times 2) \otimes (2 \times 2)$ matrix of correlators.
In the following we use the twisted basis $\chi$ for fermion fields:
<!--  -->
\begin{align}
\label{eq:LightFlavorSpinorFields}
\chi_{\ell} &= 
    \begin{bmatrix}
    {\chi}_{u} \\
    0
    \end{bmatrix}
    +
    \begin{bmatrix}
    0 \\
    {\chi}_{d}
    \end{bmatrix}
\, , \\[1em] 
\label{eq:HeavyFlavorSpinorFields}
\chi_{h} &= 
    \begin{bmatrix}
    {\chi}_{c} \\
    0
    \end{bmatrix}
    +
    \begin{bmatrix}
    0 \\
    {\chi}_{s}
    \end{bmatrix}
\, .
\end{align}
<!--  -->

## Correlators for the $K$ and $D$

The required correlators are given by the following
expectation values on the interacting vacuum
${\bra{\Omega} \cdot \ket{\Omega} = \braket{\cdot}}$:
<!--  -->
\begin{equation}
\begin{split}
{C}^{h_i, h_j}_{\Gamma_1, \Gamma_2}(t) &=
- \eta_1 \frac{1}{V} 
\sum_{\vec{x}} 
\mathcal{C}^{h_i, h_j}_{\Gamma_1, \Gamma_2}(t, \vec{x})
\\
&=
\eta_{1} \eta_{2}
\frac{1}{V} 
\sum_{\vec{x}} 
\braket{
[\bar{\chi}_{d} \Gamma_1 \chi_{h_i}](x)
[\bar{\chi}_{d} \Gamma_2 \chi_{h_j}]^{\dagger}(0)
}
\, ,
\end{split}
\end{equation}
<!--  -->
where $h_i=c,s$, $\Gamma_i = 1, \gamma_5$.
The minus sign will vanish when doing the Wick contractions,
while
$\eta_{\mathbb{1}} = 1$ and $\eta_{\gamma_5} = -1$ 
are used just to compensate the sign change when daggering the spinor bilinears at the source:
<!--  -->
\begin{equation}
\eta_\Gamma (\bar{\chi}_a \Gamma \chi_b)^\dagger = 
\eta_\Gamma \bar{\chi}_b \gamma_0 \Gamma^\dagger \gamma_0 \chi_a =
\bar{\chi}_b \Gamma \chi_a 
\, .
\end{equation}
<!--  -->

We now write the explicit Wick contractions for the object:
<!--  -->
\begin{equation}
\begin{split}
\mathcal{C}^{h_i, h_j}_{\Gamma_1, \Gamma_2}(t, \vec{x}) &=
- \eta_{2}
\braket{
[\bar{\chi}_{d} \Gamma_1 \chi_{h_i}](x)
[\bar{\chi}_{d} \Gamma_2 \chi_{h_j}]^{\dagger}(0)
}
\\
&= - \braket{
[\bar{\chi}_{d} \Gamma_1 \chi_{h_i}](x)
[\bar{\chi}_{h_j} \Gamma_2 \chi_{d}](0)
}
\end{split}
\end{equation}
<!--  -->

::: {.remark}

1. The spinor fields $\chi_{u,d}$ and $\chi_{c,s}$ of eq. 
\eqref{eq:LightFlavorSpinorFields} and 
\eqref{eq:HeavyFlavorSpinorFields} 
can be obtained with the projector:
<!--  -->
\begin{equation}
P_{i} = \frac{1}{2} [1 + (-1)^i \sigma_3] \, , \, i=0,1
\, ,
\end{equation}
<!--  -->
where ${\sigma_3 = 
    \begin{bmatrix}
    1 & 0 \\
    0 & -1
    \end{bmatrix}
    }$.
    As a projector, it satisfies $P_i^2 = P_i$.
    Moreover $\sigma_3 = \sigma_3^\dagger$, 
    hence $P_i^\dagger = P_i$.

2. Obviously, $P_i$ commutes with the $\gamma$ matrices as they act on different spaces.

3. The action of $\sigma_1$ swaps the up and down flavor components of a spinor.
:::

## Wick contractions

Using the above remarks,
we can write:
<!--  -->
\begin{equation}
\begin{split}
\mathcal{C}^{h_i, h_j}_{\Gamma_1, \Gamma_2}(t, \vec{x}) &=
- \braket{
[\bar{\chi}_{d} \Gamma_1 \chi_{h_i}](x)
[\bar{\chi}_{h_j} \Gamma_2 \chi_{d}](0)
}
\\
&= 
- \braket{
[\bar{\chi}_{\ell} \Gamma_1 (\sigma_1)^{1-i} P_i \chi_{h}](x)
[\bar{\chi}_{h} P_j (\sigma_1)^{1-j} \Gamma_2 \chi_{\ell}](0)
}
\, .
\end{split}
\end{equation}
<!--  -->
An implicit summation on flavor indices is understood.

We now call $S = D^{-1}$ the inverse of the Dirac operator
and use Wick's theorem:
<!--  -->
\begin{equation}
\braket{\Psi_{a}(x) \bar{\Psi}_{b}(0)} = S_{ab}(x|0) \, ,
\end{equation}
<!--  -->
where $a$ and $b$ are a shortcut for the other indices of the spinor (spin, flavor, color, etc.).
The correlator is:
<!--  -->
\begin{equation}
\mathcal{C}^{h_i, h_j}_{\Gamma_1, \Gamma_2}(t, \vec{x}) 
=
\operatorname{Tr} \left[
S_\ell(0|x) 
(\sigma_1)^{1-i} P_i \Gamma_1
S_h(x|0)
P_j (\sigma_1)^{1-j} \Gamma_2
\right]
\end{equation}
<!--  -->

We now use $\gamma_5$ hermiticity:
$(S_\ell) = \sigma_1 \gamma_5 S_\ell^\dagger \gamma_5 \sigma_1$.
Please note that the $\dagger$ is not on flavor space indices,
but here it makes no difference because $S_\ell$ is diagonal in flavor.
Our correlator becomes:
<!--  -->
\begin{equation}
\mathcal{C}^{h_i, h_j}_{\Gamma_1, \Gamma_2}(t, \vec{x}) 
=
\operatorname{Tr}
\left[
    S_h(x|0) 
    \Gamma_2 \gamma_5 
    P_j (\sigma_1)^{j} 
    (S_\ell)^\dagger (x|0) 
    (\sigma_1)^i P_i 
    \gamma_5 \Gamma_1
\right]
\, .
\end{equation}
<!--  -->
Upon a careful calculation for all values $i,j = 0,1$ we find, equivalently (using spacetime translational symmetry):
<!--  -->
\begin{equation}
\begin{split}
\mathcal{C}^{h_i, h_j}_{\Gamma_1, \Gamma_2}(t, \vec{x}) 
&=
\operatorname{Tr}
\left[
    (S_h)_{f_i f_j} (x|0) 
    \Gamma_2 \gamma_5 
    (S_u)^\dagger (x|0) 
    \gamma_5 \Gamma_1
\right]
\\
&=
\sum_{y,z}
\operatorname{Tr}
\left[
    (S_h)_{f_i f_j} (x+y|y) 
    \Gamma_2 \gamma_5 
    (S_u)^\dagger (x+z|z) 
    \gamma_5 \Gamma_1
    \delta_{yz}
\right]
\, .
\end{split}
\end{equation}
<!--  -->
This is a generalized case of eq. (A9) of @PhysRevD.59.074503.

We now approximate the propagator using stochastic sources.
Additionally, we use:

- The one-end-trick @Boucaud:2008xu: non vanishing source only at $x=0$.
- Same source for light and heavy doublet
- Spin dilution (cf. @foley2005practical): one source for each Dirac index $\beta$, with unit norm in color space. The components with index different from the dilution index are set to zero:
    <!--  -->
    \begin{equation}
    \eta^{(\alpha)}_{\beta, c} = 
    \eta_c \, \delta^\alpha_\beta \,\, , \, \, 
    \eta^\dagger_c \eta_c = 1 \, .
    \end{equation}
    <!--  -->
- Flavor dilution: sources have an additional flavor index $\phi$, such that their flavor component different from the index vanish. The value of the flavor component however is the same, it changes only its position in the doublet:
<!--  -->
\begin{equation}
\eta^{(\phi=0)} = 
    \begin{bmatrix}
    \eta \\
    0
    \end{bmatrix}
\, , \,
\eta^{(\phi=1)} = 
    \begin{bmatrix}
    0 \\
    \eta
    \end{bmatrix}
\, .
\end{equation}
<!--  -->


Therefore, we can use spin dilutions to rephrase the correlator in a form which will turn out to be convenient later
($c$ is the color index):
<!--  -->
\begin{equation}
\mathcal{C}^{h_i, h_j}_{\Gamma_1, \Gamma_2}(t, \vec{x}) 
=
[(S_h)_{f_i f_j}]_{\alpha_1 \beta_1} (x|0) 
[\eta^{(\alpha_2)}_{\beta_1}]_c
(\Gamma_2 \gamma_5)_{\alpha_2 \alpha_3} 
[{(\eta^\dagger)}^{(\alpha_3)}_{\beta_2}]_c
[(S_u)^\dagger]_{\beta_2 \alpha_4} (x|0) 
(\gamma_5 \Gamma_1)_{\alpha_4 \alpha_1}
\, .
\end{equation}
<!--  -->

We now define our spinor propagators.
If $\eta^{(\beta, \phi)}$ is the diluted source:
<!--  -->
\begin{align}
& (D_{\ell/h})_{\alpha_1 \alpha_2} (x|y) ({\psi}_{\ell/h}^{(\beta, \phi)})_{\alpha_2} (y)
= (\eta^{(\beta, \phi)})_{\alpha_1} (x)
\\
& \, \implies \,
(\psi_{\ell/h}^{(\beta, \phi)})_{\alpha_1} (x) 
= 
(S_{\ell/h})_{\alpha_2 \alpha_1} (x | y)
\eta^{(\beta, \phi)}_{\alpha_2} (y)
= 
(S_{\ell/h})_{\alpha_2 \alpha_1} (x | 0)
\eta^{(\beta, \phi)}_{\alpha_2} (0)
\\
& \, \implies \,
(\psi_{\ell/h}^{(\beta, \phi)})^{*}_{\alpha_1} (x) 
= 
(\eta^{(\beta, \phi)})^{*}_{\alpha_2} (y)
(S_{\ell/h}^\dagger)_{\alpha_2 \alpha_1} (x | y)
= 
(\eta^{(\beta, \phi)})^\dagger_{\alpha_2} (0)
(S_{\ell/h}^\dagger)_{\alpha_2 \alpha_1} (x | 0)
\end{align}
<!--  -->
This means that for our matrix of correlators we have to do ${4_D \times 2_f \times 2_{h,\ell}} = 16$ inversions.

::: {.remark}
1. For the light doublet `tmLQCD` computes only $S_u$, which is obtained with $(\psi_h^{(\beta, f_0)})_{f_0}$. This is the only propagator we need.
2. For the heavy propagator, we can access the $(i,j)$ component of $S_h$ with $(\psi_h^{(\beta, f_j)})_{f_i}$.
:::

Our correlator is given by the following expectation value
(no summation on flavor indices):
<!--  -->
\begin{equation}
\begin{split}
\mathcal{C}^{h_i, h_j}_{\Gamma_1, \Gamma_2}(t, \vec{x}) 
&=
\langle
[(\psi_h^{(\alpha_2, f_j)})_{f_i}]_{\alpha_1}(x)
(\Gamma_2 \gamma_5)_{\alpha_2 \alpha_3}
[(\psi_\ell^{(\alpha_3, f_0)})_{f_0}^\dagger]_{\alpha_4} (x) 
(\gamma_5 \Gamma_1)_{\alpha_4 \alpha_1}
\rangle
\\
&=
\braket{
(\psi_\ell^{(\alpha_3, f_0)})_{f_0}^\dagger (x) 
\cdot
(\gamma_5 \Gamma_1)
\cdot
(\psi_h^{(\alpha_2, f_j)})_{f_i}(x)
}
\,
(\Gamma_2 \gamma_5)_{\alpha_2 \alpha_3} 
\\
&=
\mathcal{R}^{\alpha_3 \alpha_2} (\Gamma_2 \gamma_5)_{\alpha_2 \alpha_3}
\end{split}
\end{equation}
<!--  -->

More explicitly:
<!--  -->
\begin{equation}
\begin{split}
\Gamma_2=1 &\implies \mathcal{C}^{h_i, h_j}_{\Gamma_1, \Gamma_2}(t, \vec{x}) 
= \mathcal{R}^{00}+\mathcal{R}^{11}-\mathcal{R}^{22}-\mathcal{R}^{33}
\\
\Gamma_2=\gamma_5 &\implies \mathcal{C}^{h_i, h_j}_{\Gamma_1, \Gamma_2}(t, \vec{x}) 
= \mathcal{R}^{00}+\mathcal{R}^{11}+\mathcal{R}^{22}+\mathcal{R}^{33}
\end{split}
\end{equation}
<!--  -->



## Implementation

See comments in the code: `tmLQCD/meas/correlators.c`.

**NOTE**: test if `invert_doublet_eo_quda` works (do one inversion and check the residual)



