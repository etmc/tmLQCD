\subsection{Hasenbusch trick for dynamical tmQCD}

%The trick presented in \cite{Hasenbusch:2002ai} is based on the
%observation that writing
%\[
%\det[Q^2] = \det[W^2]\cdot\det[W^{-2}Q^2]
%\]
%is advantagous for the HMC, if the condition number of $W^{2}$ and of
%$W^{-2}Q^{2}$ is significantly reduced compared to the condition number
%of only $Q^2$. Thus if we define
%\[
%\begin{split}
%  \Qpm = \gamma_5 D_W \pm i\mu_1\, ,\\
%  \Wpm = \gamma_5 D_W \pm i\mu_2\, ,\\
%\end{split}
%\]
%with $\mu_2 =\mu_1+\Delta\mu$ it follows immidiatly that the condition number of
%$\Wp\Wm$ is lower than the one of $\Qp\Qm$ if for $\lambda_{\textrm{min}}$
%and $\lambda_{\textrm{max}}$ the lowest and the largest eigenvalue of
%$\Qp\Qm$, respectively $|\lambda_{\textrm{min}}|\ll\mu_2^2\ll|\lambda_{\textrm{max}}|$
%holds: It is $|\lambda_{\textrm{max}}|/\mu_2^2$. The condition number of
%$W^{-2}Q^{2}$ contrariwise is $\mu_2^2/|\lambda_{\textrm{min}}|^2$. We can take
%$\mu_1$ which is a lower bound for $|\lambda_{\textrm{min}}|$ to write down
%the condition numbers:
%\[
%k_{W^2} = \frac{|\lambda_{\textrm{max}}|}{\mu_2^2}\, ,\quad
%k_{W^{-2}Q^{2}} \leq \frac{\mu_2^2}{\mu_1^2}\, .
%\]
%This again leads to an optimal choice for
%$\mu_2^2=\sqrt{|\lambda_{\textrm{max}}|\cdot\mu_1}$. It is also illuminating to take
%a look at the force coming from $W^{-2}Q^{2}$. Noticing that
%\[
%\Wpm = \Qpm \pm i\Delta\mu\, ,
%\]
%we see immidiatly that
%\begin{equation}
%  \label{eq:mt01}
%  \Wpm^{-1}\Qpm = \mathds{1} \mp i\Delta\mu\Wpm^{-1}\, .
%\end{equation}
%Now we again write the determinant with pseudo fermion
%fields:
%\[
%\begin{split}
%  \det[\Wp^{-1}\Qp\Qm\Wm^{-1}] &= \int D[\phi]D[\phi^\dagger]
%  \exp(-\phi^\dagger\Wm\Qm^{-1}\Qp^{-1}\Wp\phi) \\
%  &=  \int D[\phi]D[\phi^\dagger] \exp(-S_F)\, .
%\end{split}
%\]
%Using equation (\ref{eq:mt01}) we get the following expression for
%$S_F$:
%\begin{equation}
%  \label{eq:mt02}
%  S_F = \phi^\dagger(\mathds{1} +i\Delta\mu\Qp^{-1}
%  -i\Delta\mu\Qm^{-1}+\Delta\mu^2(\Qp\Qm)^{-1}) \phi\, .
%\end{equation}
%Without explicitly computing the variation of $S_F$ with respect to
%the gauge fields we can see that it can only contain term proportional
%to $\Delta\mu$ and $\Delta\mu^2$, since $S_F$ is a constant up to terms of this
%order. If we take $\Delta\mu$ to be small we expect a smaller force comming
%from $W^{-2}Q^{2}$ than it would come from $Q^2$ and therefore a
%smoother evolution of the Hamiltonian.

%This we will now apply on top of even odd preconditioning. For this we
%start directly with the even odd preconditioned matrices $\hQpm$, but
%probably it is also possible to start from the results obtained in
%this subsection. Nevertheless the above discussion was usefull to
%understand a possible gain with this trick.

We shall now discuss the the trick presented in
\cite{Hasenbusch:2002ai} (mass preconditioning) for dynamical twisted
mass lattice QCD.
Let $\hQpm$ and $\hWpm$ be two matrices as defined in (\ref{eq:eo4})
with two parameters $\mu_1$ and $\mu_2$, respectively. The idea is to
choose $\mu_2$ bigger than $\mu_1$. With this we can
write
\begin{equation}
  \label{eq:mt0}
  \det[\hQp\hQm] = \det[\hWp\hWm]\cdot\det[\hWp^{-1}\hQp\hQm\hWm^{-1}].
\end{equation}
The first term on the right hand side of (\ref{eq:mt0}) can be handled
as described in the previous section. The second term needs some
further investigation: we again write the determinant as an integral
over pseudo fermion fields:
\begin{equation}
  \label{eq:mt1}
  \begin{split}
    \det[\hWp^{-1}\hQp\hQm\hWm^{-1}]  &\propto \int
    D[\phi_o]D[\phi_o^\dagger]\exp(-\phi_o^\dagger (\hWp^{-1}\hQp\hQm\hWm^{-1})^{-1}
    \phi_o) \\
    &= \int D[\phi_o]D[\phi_o^\dagger]\exp(-\phi_o^\dagger \hWm\hQm^{-1}\hQp^{-1}\hWp\phi_o) \\
    &= \int D[\phi_o]D[\phi_o^\dagger]\exp(-S_{F_2})
  \end{split}
\end{equation}
The variation of $S_{F_2}$, needed for the HMC, then reads as follows:
\begin{equation}
  \label{eq:mt2}
  \begin{split}
    \delta S_{F_2} &= \phi_o^\dagger[\delta\hWm(\hQp\hQm)^{-1}\hWp
    +\hWm(\hQp\hQm)^{-1}\delta\hWp]\phi_o\\
    &-\phi_o^\dagger[\hWm\hQm^{-1}\delta\hQm(\hQp\hQm)^{-1}\hWp +
    \hWm(\hQp\hQm)^{-1}\delta\hQp\hQp^{-1}\hWp]\phi_o
  \end{split}
\end{equation}
If we define now
\begin{equation}
  \label{eq:mt3}
  X_W = (\hQp\hQm)^{-1}\hWp\phi_o\, ,\quad Y_W = \hQp^{-1}\hWp\phi_o = \hQm
  X_W\, ,
\end{equation}
we can rewrite (\ref{eq:mt2}):
\begin{equation}
  \label{eq:mt4}
  \begin{split}
    \delta S_{F_2} &= \phi_o^\dagger\delta\hWm X_W + X_W^\dagger\delta\hWp\phi_o\\
    &-Y_W^\dagger\delta\hQm X_W - X_W^\dagger\delta\hQp Y_W\, .
  \end{split}
\end{equation}
Recalling the variation of $\hQpm$ (and of $\hWpm$):
\begin{equation}
  \label{eq:mt5}
  \begin{split}
    \delta\hQpm &= \gamma_5\left(-\delta M_{oe}(1\pm i\mu_1\gamma_5 )^{-1}M_{eo} -
      M_{oe}(1\pm i\mu_1\gamma_5 )^{-1}\delta M_{eo}\right)\, , \\
    \delta\hWpm &= \gamma_5\left(-\delta M_{oe}(1\pm i\mu_2\gamma_5 )^{-1}M_{eo} -
      M_{oe}(1\pm i\mu_2\gamma_5)^{-1}\delta M_{eo}\right)\, ,
  \end{split}
\end{equation}
we find:
\begin{equation}
  \label{eq:mt6}
  \begin{split}
    \delta S_{F_2} &= Y_2^\dagger \delta Q X_2 + X_2^\dagger\delta QY_2 -X_1^\dagger\delta Q Y_1 -
    Y_1^\dagger\delta Q X_1\\
    &= 2\re\left[Y_2^\dagger \delta Q X_2 - Y_1^\dagger\delta Q X_1 \right]\, ,
  \end{split}
\end{equation}
where the fields $X_{1,2}$, $Y_{1,2}$ and the matrix $\delta Q$ are now
defined over the full lattice as follows:
\begin{equation}
  \label{eq:mt7}
  \begin{split}
    Y_1 &= 
    \begin{pmatrix}
      -(1+i\mu_{1}\gamma_5)^{-1}M_{eo}Y_W \\ Y_W\\
    \end{pmatrix}\, ,\quad
    Y_2 = 
    \begin{pmatrix}
      -(1+i\mu_{2}\gamma_5)^{-1}M_{eo}\phi_o \\ \phi_o\\
    \end{pmatrix},\\
    X_{1,2} &= 
    \begin{pmatrix}
      -(1-i\mu_{1,2}\gamma_5)^{-1}M_{eo}X_W \\ X_W\\
    \end{pmatrix},\quad
    \delta Q = \gamma_5
    \begin{pmatrix}
      0 & \delta M_{eo}\\
      \delta M_{oe} & 0\\
    \end{pmatrix}\, .
  \end{split}
\end{equation}
The bosonic part is again quadratic in the fields $\phi_o$ and can be
therefore generated at the beginning of each molecular dynamics
trajectory with:
\begin{equation}
  \label{eq:mt8}
  \phi_o = \hWp^{-1}\hQp R
\end{equation}
where $R$ is again a random spinor field taken from a Gaussian
distribution with norm one.

This can again be used also with symmetrical even/odd preconditioning
by re-defining $Y_{1,2}$ and $X_{1,2}$
\begin{equation}
  \label{eq:mt9}
  \begin{split}
    Y_1 &= 
    \begin{pmatrix}
      -(1+i\mu_{1}\gamma_5)^{-1}M_{eo}(1+i\mu_{1}\gamma_5)^{-1}Y_W \\ Y_W\\
    \end{pmatrix}\, \\
    Y_2 &= 
    \begin{pmatrix}
      -(1+i\mu_{2}\gamma_5)^{-1}M_{eo}(1+i\mu_{2}\gamma_5)^{-1}\phi_o \\ \phi_o\\
    \end{pmatrix},\\
    X_{1,2} &= 
    \begin{pmatrix}
      -(1-i\mu_{1,2}\gamma_5)^{-1}M_{eo}(1-i\mu_{1,2}\gamma_5)^{-1}X_W \\ X_W\\
    \end{pmatrix}\, .\\
  \end{split}
\end{equation}

\subsubsection{Hasenbusch-Trick and Twisted-Clover}

In order to avoid to recompute $(1\pm i \mu\gamma_5 + T_{ee}(x))^{-1}$
too often, the following version of mass preconditioning -- which is
close to the original paper~\cite{Hasenbusch:2002ai} -- might be best
suited for Twisted-Clover: define
\begin{equation}
  \label{eq:swWhat}
  \hWpm = \hQpm \pm i \rho = \gamma_5(\hat{M_\pm} \pm i \rho\gamma_5)
\end{equation}
with a real mass-shift $\rho$. Here $\hQpm$ is now the even/odd
preconditioned clover operator eq.~(\ref{eq:eosw4})
\[
\hQpm = \gamma_5((1 + T_{oo} \pm i\tilde\mu\gamma_5) -
             M_{oe}( 1 + T_{ee} \pm i\tilde\mu\gamma_5 )^{-1}M_{eo})\,.
\]
Then we have $\hWp = \hWm^\dagger$ and $\delta \hQpm =
\delta\hWpm$. The latter is given by eq.~(\ref{eq:eosw7})
\begin{equation*}
  \begin{split}
    \delta \hQpm = \gamma_5 & \left( \delta T_{oo}-\delta M_{oe}(M_{ee}^\pm )^{-1}M_{eo} -
      M_{oe}(M_{ee}^\pm )^{-1}\delta M_{eo}\right. \\
  &\left. + M_{oe}(M_{ee}^\pm )^{-1} \delta T_{ee} (M_{ee}^\pm )^{-1} M_{eo}\right),
  \end{split}
\end{equation*}
which is in particular independent of $\rho$. 
The pseudo-fermion action of a determinant ratio is then
given by
\[
S_\mathrm{PF} = \phi^\dagger\hWm(\hQp\hQm)^{-1}\hWp\phi
\]
and the variation of $S_\mathrm{PF}$ is again given by
eq.~(\ref{eq:mt2}). We also define again $X_W$ and $Y_W$ as in
eq.~(\ref{eq:mt3})
\begin{equation*}
  X_W = (\hQp\hQm)^{-1}\hWp\phi_o\, ,\quad Y_W = \hQp^{-1}\hWp\phi_o = \hQm
  X_W\, 
\end{equation*}
With this definition the variation of
$S_\mathrm{PF}$ reads
\begin{equation}
  \label{eq:swdeltaS}
  \begin{split}
    \delta S_\mathrm{PF} &= \phi^\dagger\delta\hQm X_W + X_W^\dagger
    \delta \hQp\phi - Y_W^\dagger\delta \hQm X_W - X_W^\dagger\delta\hQp
    Y_W\\
    &= (\phi- Y_W)^\dagger\delta\hQm X_W + X_W^\dagger\delta\hQp(\phi
    - Y_W) \\
    &= 2\re[ (\phi- Y_W)^\dagger\delta\hQm X_W ]\,.
  \end{split}
\end{equation}
Defining analogously to eq.~(\ref{eq:mt7}) two full vectors $X,Y$ as
follows 
\begin{equation}
  \label{eq:swXY}
  \begin{split}
    Y &= 
    \begin{pmatrix}
      -(1+i\mu\gamma_5+T_{ee}(x))^{-1}M_{eo} (\phi-Y_W) \\ (\phi-Y_W)\\
    \end{pmatrix}\, ,\\
    X &= 
    \begin{pmatrix}
      -(1-i\mu\gamma_5+T_{ee}(x))^{-1}M_{eo}X_W \\ X_W\\
    \end{pmatrix}\,,
  \end{split}
\end{equation}
we get
\begin{equation}
  \label{eq:swdS}
  \delta S_\mathrm{PF} = 2 \re[Y^\dagger\, \delta Q\, X]\,,
\end{equation}
where again
\[
\delta Q = \gamma_5
\begin{pmatrix}
  \delta T_{ee} & \delta M_{eo}\\
  \delta M_{oe} & \delta T_{oo}\\
\end{pmatrix}\,.
\]

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "main"
%%% End: 
